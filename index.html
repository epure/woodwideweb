<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>WoodWideWeb - AR Gallery</title>
    
    <!-- MindAR & A-Frame -->
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
        
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: white;
            font-family: 'Arial', sans-serif;
        }
        
        #loading-screen.hidden {
            display: none;
        }
        
        .loading-title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
            letter-spacing: 2px;
        }
        
        .loading-text {
            font-size: 16px;
            margin-top: 20px;
            opacity: 0.8;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-top: 5px solid #4CAF50;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-top: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .logo {
            font-family: Georgia, serif;
            font-size: 36px;
            margin-bottom: 30px;
            color: #4CAF50;
        }
    </style>
</head>
<body>
    <!-- ﾃ営ran de chargement -->
    <div id="loading-screen">
        <div class="logo">沍ｲ WoodWideWeb 沍ｲ</div>
        <div class="loading-title">Galerie AR</div>
        <div class="spinner"></div>
        <div class="loading-text">Chargement de l'expﾃｩrience AR...</div>
    </div>

    <!-- Scﾃｨne AR -->
    <a-scene 
        mindar-image="
            imageTargetSrc: ./targets.mind;
            maxTrack: 1;
            filterMinCF: 0.001;
            filterBeta: 100;
            missTolerance: 15;
            warmupTolerance: 5
        "
        color-space="sRGB" 
        renderer="colorManagement: true, physicallyCorrectLights"
        vr-mode-ui="enabled: false" 
        device-orientation-permission-ui="enabled: false"
    >
        <!-- Assets -->
        <a-assets>
            <!-- Vidﾃｩo unique pour toutes les ﾅ砥vres (test) -->
            <video 
                id="shared-video" 
                src="https://res.cloudinary.com/dmgx02nlp/video/upload/v1770030665/WoodWideWeb_01_kj0sqr.mp4" 
                preload="auto" 
                loop 
                crossorigin="anonymous" 
                playsinline 
                webkit-playsinline
            ></video>
        </a-assets>

        <!-- Camﾃｩra -->
        <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

        <!-- ﾅ置vre 01 -->
        <a-entity id="target-01" mindar-image-target="targetIndex: 0">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 02 -->
        <a-entity id="target-02" mindar-image-target="targetIndex: 1">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 03 -->
        <a-entity id="target-03" mindar-image-target="targetIndex: 2">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 04 -->
        <a-entity id="target-04" mindar-image-target="targetIndex: 3">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 05 -->
        <a-entity id="target-05" mindar-image-target="targetIndex: 4">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 06 -->
        <a-entity id="target-06" mindar-image-target="targetIndex: 5">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 07 -->
        <a-entity id="target-07" mindar-image-target="targetIndex: 6">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 08 -->
        <a-entity id="target-08" mindar-image-target="targetIndex: 7">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 09 -->
        <a-entity id="target-09" mindar-image-target="targetIndex: 8">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 10 -->
        <a-entity id="target-10" mindar-image-target="targetIndex: 9">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 11 -->
        <a-entity id="target-11" mindar-image-target="targetIndex: 10">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 12 -->
        <a-entity id="target-12" mindar-image-target="targetIndex: 11">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 13 -->
        <a-entity id="target-13" mindar-image-target="targetIndex: 12">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 14 -->
        <a-entity id="target-14" mindar-image-target="targetIndex: 13">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 15 -->
        <a-entity id="target-15" mindar-image-target="targetIndex: 14">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 16 -->
        <a-entity id="target-16" mindar-image-target="targetIndex: 15">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 17 -->
        <a-entity id="target-17" mindar-image-target="targetIndex: 16">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 18 -->
        <a-entity id="target-18" mindar-image-target="targetIndex: 17">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 19 -->
        <a-entity id="target-19" mindar-image-target="targetIndex: 18">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 20 -->
        <a-entity id="target-20" mindar-image-target="targetIndex: 19">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 21 -->
        <a-entity id="target-21" mindar-image-target="targetIndex: 20">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 22 -->
        <a-entity id="target-22" mindar-image-target="targetIndex: 21">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 23 -->
        <a-entity id="target-23" mindar-image-target="targetIndex: 22">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>

        <!-- ﾅ置vre 24 -->
        <a-entity id="target-24" mindar-image-target="targetIndex: 23">
            <a-video 
                src="#shared-video" 
                width="1" 
                height="1" 
                position="0 0 0"
            ></a-video>
        </a-entity>
    </a-scene>

    <script>
        // Gestion des ﾃｩvﾃｩnements de dﾃｩtection avec vidﾃｩo partagﾃｩe
        document.addEventListener('DOMContentLoaded', function() {
            const loadingScreen = document.getElementById('loading-screen');
            const sceneEl = document.querySelector('a-scene');
            
            // Cacher l'ﾃｩcran de chargement quand l'AR est prﾃｪt
            sceneEl.addEventListener('arReady', () => {
                console.log('MindAR est prﾃｪt !');
                loadingScreen.classList.add('hidden');
            });
            
            // Rﾃｩfﾃｩrence ﾃ la vidﾃｩo partagﾃｩe
            const sharedVideo = document.getElementById('shared-video');
            
            // Gestion de la lecture/pause vidﾃｩo pour chaque ﾅ砥vre
            for (let i = 1; i <= 24; i++) {
                const targetId = `target-${String(i).padStart(2, '0')}`;
                const target = document.getElementById(targetId);
                
                if (target) {
                    // Quand l'image est dﾃｩtectﾃｩe
                    target.addEventListener('targetFound', () => {
                        console.log(`ﾅ置vre ${i} dﾃｩtectﾃｩe - lecture vidﾃｩo partagﾃｩe`);
                        sharedVideo.play().catch(err => {
                            console.warn(`Erreur lecture vidﾃｩo:`, err);
                        });
                    });
                    
                    // Quand l'image est perdue
                    target.addEventListener('targetLost', () => {
                        console.log(`ﾅ置vre ${i} perdue - pause vidﾃｩo`);
                        sharedVideo.pause();
                        sharedVideo.currentTime = 0; // Remettre au dﾃｩbut
                    });
                }
            }
        });
    </script>
</body>
</html>
